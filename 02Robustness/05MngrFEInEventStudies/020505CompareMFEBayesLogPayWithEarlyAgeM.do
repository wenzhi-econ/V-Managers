/* 
This do file compares manager FE with the EarlyAgeM measure.

Input:
    "${TempData}/04MainOutcomesInEventStudies_EarlyAgeM.dta" <== constructed in 0102 do file.
    "${TempData}/temp_MngrID_MFEBayesLogPay.dta" <== constructed in 0804 do file

RA: WWZ 
Time: 2024-10-30
*/

*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??
*?? step 1. merge MFEBayesLogPay measure 
*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??

use "${TempData}/04MainOutcomesInEventStudies_EarlyAgeM.dta", clear 

keep if FT_Rel_Time!=. 
keep if FT_Mngr_both_WL2==1
    //&? keep a worker panel that contains only the event workers 

merge m:1 IDlseMHR using "${TempData}/temp_MngrID_MFEBayesLogPay.dta", keep(match) nogenerate
    //&? keep only those managers whose manager FE can be identified

keep if FT_Rel_Time==0
    //&? a cross-section of event workers whose manager (event or non-event) FE can be identified 

keep IDlseMHR EarlyAgeM MFEBayesLogPay MFEBayesLogPay_Med MFEBayesLogPay_p75
duplicates drop 
    //&? 8,530 different managers 

save "${TempData}/temp_Mngr_MFEBayesLogPay_EarlyAgeM.dta", replace 

*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??
*?? step 2. correlation 
*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??

use "${TempData}/temp_Mngr_MFEBayesLogPay_EarlyAgeM.dta", clear 

correlate EarlyAgeM MFEBayesLogPay_Med MFEBayesLogPay_p75
/* 
             | EarlyA~M MFEBay~d MFEBa~75
-------------+---------------------------
   EarlyAgeM |   1.0000
MFEBayesLo~d |   0.0299   1.0000
MFEBayesL~75 |   0.0664   0.5728   1.0000

*/

*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??
*?? step 2. distribution for L- and H-type (based EarlyAgeM measure) managers  
*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??*??

label variable MFEBayesLogPay "Manager FE"

histogram MFEBayesLogPay, fraction by(EarlyAgeM)

graph export "${Results}/DistOfMFEBayesLogPayByEarlyAgeM.png", replace as(png)
